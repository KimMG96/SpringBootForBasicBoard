<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.toyproject.springbootforbasicboard.auth.service.mapper.AuthMapper">

    <select id="selectAllUsersCount" resultType="int">
        <![CDATA[
        SELECT COUNT(*)
        FROM userInfo
        ]]>
    </select>

    <select id="selectAllUsers" resultType="java.util.Map">
        <![CDATA[
        SELECT *
        FROM userInfo
        ]]>
    </select>

    <select id="selectUserCountByUserId" parameterType="string" resultType="int">
        <![CDATA[
        SELECT
            COUNT(*)
        FROM userInfo
        WHERE 1=1
            AND uiId = #{uiId}
        ]]>
    </select>

    <select id="selectUserCountByUserIdWithPwd" parameterType="java.util.Map" resultType="int">
        <![CDATA[
        SELECT
            COUNT(*)
        FROM userInfo
        WHERE 1=1
            AND uiId = #{uiId}
            AND uiPwd = #{uiPwd}
        ]]>
    </select>

    <select id="selectUserInfoByUserIdUserPwd" parameterType="java.util.Map" resultType="java.util.Map">
        <![CDATA[
        SELECT
            *
        FROM userInfo
        WHERE 1=1
            AND uiId = #{uiId}
            AND uiPwd = #{uiPwd}
        ]]>
    </select>

    <insert id="insertUserInfo" parameterType="java.util.Map">
        <![CDATA[
        INSERT INTO userInfo
            (uiId, uiPwd, uiName, uiPhone, uiEmail, uiCrtDate, uiState, uiAuth)
        VALUES
            (#{uiId}, #{uiPwd}, #{uiName}, #{uiPhone}, #{uiEmail},#{uiCrtDate}, 1, 1)
        ]]>
        <selectKey resultType="int" keyProperty="uiIdx">
            SELECT LAST_INSERT_ID()
        </selectKey>
    </insert>

    <insert id="insertUseHistoryInfo" parameterType="java.util.Map">
        <![CDATA[
        INSERT INTO userHistory
            (uhCrtDate, uiIdx, uhDetail)
        VALUES
            (#{uhCrtDate}, #{uiIdx}, #{uhDetail})
        ]]>
    </insert>

</mapper>